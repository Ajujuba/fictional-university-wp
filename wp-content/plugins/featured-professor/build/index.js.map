{"version":3,"file":"index.js","mappings":"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","sources":["webpack://featured-professor/./src/index.scss","webpack://featured-professor/external window \"React\"","webpack://featured-professor/external window [\"wp\",\"apiFetch\"]","webpack://featured-professor/external window [\"wp\",\"data\"]","webpack://featured-professor/webpack/bootstrap","webpack://featured-professor/webpack/runtime/compat get default export","webpack://featured-professor/webpack/runtime/define property getters","webpack://featured-professor/webpack/runtime/hasOwnProperty shorthand","webpack://featured-professor/webpack/runtime/make namespace object","webpack://featured-professor/./src/index.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"React\"];","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"data\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import \"./index.scss\"\nimport {useSelect} from \"@wordpress/data\" //This imports the useSelect function from the WordPress state management package. This function is used to fetch data from the WordPress global state.\nimport {useState, useEffect} from \"react\" //This imports the useState and useEffect functions from React. They are used to manage local state and side effects in the React component.\nimport apiFetch from \"@wordpress/api-fetch\" //This imports the apiFetch function, which is used to make requests to the WordPress REST API.\nconst __ = wp.i18n.__ //create a shortcut from the global scope of WP, The Loco Translate doens't work very well if we not use this directly\n\nwp.blocks.registerBlockType(\"ourplugin/featured-professor\", {\n  title: \"Professor Callout\",\n  description: \"Include a short description and link to a professor of your choice\",\n  icon: \"welcome-learn-more\",\n  category: \"common\",\n  attributes: {\n    profId: {type: \"string\"}\n  },\n  edit: EditComponent,\n  save: function () {\n    return null\n  }\n})\n\nfunction EditComponent(props) {\n  const [thePreview, setThePreview] = useState(\"\") ; // Local state is managed with useState, and the initial value of thePreview is an empty string.\n  \n  //Fired when the props.attributes.profId property changes, and is used to fetch and update the teacher's HTML based on this ID\n  useEffect(() => {\n    updateTheMeta();\n    async function go(){\n      const response = await apiFetch({ // call to the WordPress REST API using apiFetch. It is looking for the teacher's HTML based on the ID provided in props.attributes.profId.\n        path: `featuredProfessor/v1/getHTML?profId=${props.attributes.profId}`,\n        method: \"GET\",\n      })\n      setThePreview(response) //updates thePreview local state with the HTML returned by the API.\n    }\n    go()\n  }, [props.attributes.profId]); //The useEffect function is used to make a request to the WordPress REST API to get the teacher's HTML based on the profId provided in the block properties.\n\n  //is executed once, when the component is unmounted, and is used to update the metadata of the \"Featured Professor\" block before it is unmounted. This ensures that metadata is always up to date in WordPress. + (continue in the next line)\n  //here, you return a function that will be executed when the component is disassembled. React automatically calls this function when the component is removed from the DOM. This is a fundamental part of the React components lifecycle.\n  useEffect(() => {\n    return () => {\n      updateTheMeta(); //This returns a function that is executed when the component is unmounted. In this case, the updateTheMeta function is called when the component is about to be unmounted, which updates the metadata before the component is removed.\n    }\n  },[]);// The absence of dependencies ([]) means that this callback function will be called only once, when the component is mounted, and again when the component is unmounted.\n\n  //This function will update our meta, creating a new meta:\n  function updateTheMeta(){\n    const profsForMeta = wp.data.select(\"core/block-editor\")\n      .getBlocks()\n      .filter(x => x.name == \"ourplugin/featured-professor\") // Filter only blocks of type \"ourplugin/featured-professor\"\n      .map(x => x.attributes.profId) // Map to get the \"profId\" attribute of each block\n      .filter((x, index, arr) => {\n        return arr.indexOf(x) == index // Remove duplicate values\n      })\n    console.log(profsForMeta)\n\n    // Trigger an action to update the post metadata\n    wp.data.dispatch(\"core/editor\").editPost({meta: {featuredprofessor: profsForMeta}})\n  }\n\n  const allProfs = useSelect(select => {\n    return select(\"core\").getEntityRecords(\"postType\", \"professor\", {per_page: -1})\n  }); //I'm getting the professors' data here\n  console.log(allProfs)\n\n  //as this solution of getting the teachers takes a few milliseconds to return a response, if the user accesses it without having loaded the block it appears as 'Loading...' \n  if(allProfs == undefined){\n    return <p>Loading...</p>\n  } \n\n  //and when it has allProfs defined, it returns the real block to me where the user can choose a teacher and a <div> where the selected teacher's HTML is rendered using dangerouslySetInnerHTML.\n  return (\n    <div className=\"featured-professor-wrapper\">\n      <div className=\"professor-select-container\">\n        <select onChange={ e => props.setAttributes({profId: e.target.value})}>\n          <option value=\"Select a professor\">{__('Select a professor', 'featured-professor')}</option>\n          {allProfs.map(prof => {\n            return (\n              <option value={prof.id} selected={props.attributes.profId == prof.id}> {prof.title.rendered} </option>\n            )\n          })}\n        </select>\n      </div>\n      <div dangerouslySetInnerHTML={{__html: thePreview}}>\n      </div>\n    </div>\n  )\n}"],"names":["useSelect","useState","useEffect","apiFetch","__","wp","i18n","blocks","registerBlockType","title","description","icon","category","attributes","profId","type","edit","EditComponent","save","props","thePreview","setThePreview","updateTheMeta","go","response","path","method","profsForMeta","data","select","getBlocks","filter","x","name","map","index","arr","indexOf","console","log","dispatch","editPost","meta","featuredprofessor","allProfs","getEntityRecords","per_page","undefined","createElement","className","onChange","e","setAttributes","target","value","prof","id","selected","rendered","dangerouslySetInnerHTML","__html"],"sourceRoot":""}